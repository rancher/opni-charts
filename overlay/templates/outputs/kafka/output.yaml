{{- if .Values.kafka.enabled }}
apiVersion: logging.banzaicloud.io/v1beta1
kind: ClusterOutput
metadata:
  name: {{ .Release.Name }}-kafka
spec:
  kafka:
    brokers: {{ .Values.kafka.brokers }}
    default_topic: {{ .Values.kafka.default_topic }}
    sasl_over_ssl: {{ .Values.kafka.sasl_over_ssl }}
    scram_mechanism: {{ .Values.kafka.scram_mechanism }}
    format:
      type: json

  {{- if .Values.kakfa.username }}
    username:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "username"
  {{- end }}
  {{- if .Values.kakfa.password }}
    password:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "password"
  {{- end }}
  {{- if .Values.kakfa.ssl_ca_cert }}
    ssl_ca_cert:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "ssl_ca_cert"
  {{- end }}
  {{- if .Values.kakfa.ssl_client_cert }}
    ssl_client_cert:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "ssl_client_cert"
  {{- end }}
  {{- if .Values.kakfa.ssl_client_cert_chain }}
    ssl_client_cert_chain:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "ssl_client_cert_chain"
  {{- end }}
  {{- if .Values.kakfa.ssl_client_cert_key }}
    ssl_client_cert_key:
      valueFrom:
        secretKeyRef:
          name: {{ .Release.Name }}-kafka
          key: "ssl_client_cert_key"
  {{- end }}
{{- end }}
